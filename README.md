# pluscal_examples

В файле **dataholder.tla** написан примитив с [лекции 13 part 2](https://youtu.be/DccZE5PYhZM?t=1461).

## Запуск 
- [скачать tla+ toolbox](https://github.com/tlaplus/tlaplus/releases)
- открыть спецификацию (File -> Open Spec -> Add new spec)
- создать модель и в **Invariants** дописать PCorrect, в **What is the behavior spec?** выбрать *Temporal formula* и прописать Spec
- запустить модель. справа в **error-trace** будет выдана последовательность конфигураций состояний программы, в конце которой нарушается инвариант. справа в верху этого подокошка есть кнопочка для колапса сразу всех элементов.

Также можно перекоментить **Copy** на корректный вариант и убедиться, что ничего не ломается, или, например, найти исполнение в котором два раза считается кэш. *macro* в TLA+ по сути определяет абстрактную атомарную операцию. 

## Достоинства метода

Можно тестировать многопоточные примитивы в алгоритмах где их применяют. Также есть возможность записи в виде темпоральных формул требования прогресса исполнения или, например отсутсвия голодания. Подробнее можно прочесть у товарища [Лэйсли Лемпорта](http://lamport.azurewebsites.net/tla/learning.html) в его затеханных pdf'ках (latex тоже его заслуга, кстати).

## Недосатки

- Все равно получается unit-test тестирование
- На реальный код плохо переносимо из-за медлительности поиска по графу конфигураций
- Парсер toolbox просто ужасен, ошибки показываются совсем не там где должны. Потратил пару часов чтобы понять что метки на каждой строке вызывали великоленую по информативности ошибку "Expected "{" but found * " в конце кода

